<!-- index.html -->

{% load static %}
<!DOCTYPE html>
<html>
<head lang="ja">
    <meta charset="UTF-8">
    <title>{{ user.username }}ã®ãƒšãƒ¼ã‚¸</title>
    
  

    
    


    
  <link rel="shortcut icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">

  <link rel="stylesheet" type="text/css" href="{% static 'css/index.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<body style="background-image: none;">
  


  <div class="container">


  <div class="header">
    <a href="{% url 'upload_character_images' %}" class="icon mobile-hide">
      <i class="fa fa-user-edit"></i> <div class="mobile-hide">ã‚¢ãƒã‚¿ãƒ¼</div>
    </a>
    <a href="{% url 'update_prompt' %}" class="icon mobile-hide">
      <i class="fa fa-edit"></i> <div class="mobile-hide">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</div>
    </a>
    <a href="{% url 'update_voice_model' %}" class="icon mobile-hide voice">
      <i class="fa fa-microphone"></i><div class="mobile-hide">ãƒœã‚¤ã‚¹</div> 
    </a>
    
    
  </div>




{% comment %} <body style="background-color: {{ background_color | default:'#ffffff' }};"> {% endcomment %}


<!-- ä½“ -->
<div id="character" class="character">
  {% if character.get_body_image_url %}
      <img src="{{ character.get_body_image_url }}" alt="Body" class="character-part  user-uploaded-image">
  {% else %}
      <img src="{% static 'images/body.png' %}" alt="Body" class="character-part">
  {% endif %}


  {% if character.get_open_eyes_image_url %}
  <img id="eye-image" src="{{ character.get_open_eyes_image_url }}" data-open="{{ character.get_open_eyes_image_url }}" data-closed="{{ character.get_close_eyes_image_url }}" alt="Open Eyes" class="character-part user-uploaded-image">
{% else %}
  <img id="eye-image" src="{% static 'images/eyes.png' %}" data-open="{% static 'images/eyes.png' %}" data-closed="{% static 'images/eyes_close.png' %}" alt="Eyes" class="character-part">
{% endif %}






  <!-- é–‹ã„ãŸå£ -->
{% if character.get_open_mouth_image_url %}
    <img id="mouth-image-open-user" src="{{ character.get_open_mouth_image_url }}" alt="Open Mouth" class="character-part user-uploaded-image user-mouth" style="display: none;">
{% else %}
    <img id="mouth-image-open" src="{% static 'images/mouth_close.png' %}" alt="Open Mouth" class="character-part">
{% endif %}

<!-- åŠåˆ†é–‹ã„ãŸå£ -->
{% if character.get_half_open_mouth_image_url %}
    <img id="mouth-image-half-user" src="{{ character.get_half_open_mouth_image_url }}" alt="Half Open Mouth" class="character-part user-uploaded-image user-mouth" style="display: none;">
{% else %}
    <img id="mouth-image-half" src="{% static 'images/mouth_open.png' %}" alt="Half Open Mouth" class="character-part">
{% endif %}

<!-- é–‰ã˜ãŸå£ -->
{% if character.get_closed_mouth_image_url %}
    <img id="mouth-image-user" src="{{ character.get_closed_mouth_image_url }}" alt="Closed Mouth" class="character-part user-uploaded-image user-mouth">
{% else %}
    <img id="mouth-image" src="{% static 'images/mouth_close.png' %}" alt="Closed Mouth" class="character-part">
{% endif %}






</div>











</div>
<div id="error-message-container" class="error-message"></div>

<form id="chat-form" class="chat-form-container">
  <button id="mic-button" class="toggle-mic">
    <i class="fa fa-microphone"></i></i>
  </button>

  <textarea class="input-field" name="text_input" id="text_input" 
            placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„" 
            rows="1" cols="50" maxlength="100" 
            aria-required="true" required></textarea>

  <input type="submit" class="submit-button" value="â–¶" aria-label="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡">

  <div class="audio-controls">
    <button class="toggle-audio">ğŸ”Š/ğŸ”‡</button>
    <input type="range" class="volume-slider" min="0" max="100" value="100">
  </form>
</div>


 <!-- èƒŒæ™¯ -->
{% if character.get_background_image_url %}
<img src="{{ character.get_background_image_url }}" alt="Background" class="character-part background">
{% endif %} 
</div> 





<div id="chat_area" style="chat_area">

<div id="message-container"></div>




<div class="sidebar">
  <a href="{% url 'my_page' %}" class="sidebar-icon">
    <i class="fas fa-cog"></i>
</a>
  <a href="{% url 'help' %}" class="sidebar-icon">
      <i class="fas fa-question-circle"></i>
  </a>
</div>




<div class="loader"></div>




 <!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
<div id="error-message-container" class="error-message"></div>




<!-- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å‘ä¸Šã®ãŸã‚ã«aria-liveã‚’ä½¿ç”¨ -->
<div id="feedback-container" aria-live="assertive">
  <div id="response-text"></div>
  <!-- IDã‚’ä¿®æ­£ã—ã¾ã—ãŸ -->
  <div id="error-message" class="error-message"></div>
</div>







  <script src="//cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script type="text/javascript" src="{% static 'js/index.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/character_position.js' %}"></script>

  <script src="{% static 'js/voice_recognition.js' %}"></script>
  <script src="{% static 'js/drag_and_zoom.js' %}"></script>

  
  


<!-- é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’JavaScriptã«æ¸¡ã™ -->
<script type="text/javascript">
  console.log("Background color from template:", '{{ background_color }}');


  document.addEventListener('DOMContentLoaded', function() {
    if (backgroundColor && backgroundColor !== '#ffffff') {
        document.body.style.backgroundColor = backgroundColor;
        document.body.style.backgroundImage = 'none';
    
    }
  });
  
  

  window.staticFilePaths = {
    mouthOpen: '{% static "images/mouth_open.png" %}',
    mouthHalf: '{% static "images/mouth_half.png" %}',
    mouthClose: '{% static "images/mouth_close.png" %}',
    eyesOpen: '{{ character.get_open_eyes_image_url }}',
    eyesClosed: '{{ character.get_closed_eyes_image_url }}',
  };

  var isUserLoggedIn = {{ request.user.is_authenticated|lower }};
  var backgroundColor = '{{ background_color }}';  // Djangoãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¤‰æ•°ã‚’JavaScriptå¤‰æ•°ã«ã‚»ãƒƒãƒˆ


</script>
<script type="module" src="{% static 'js/eyes_animation.js' %}"></script>
<script type="module" src="{% static 'js/voice_recognition.js' %}"></script>
<script type="module" src="{% static 'js/chat.js' %}"></script>
<script type="module" src="{% static 'js/chat_message.js' %}"></script>
<script type="module" src="{% static 'js/mouth_animation.js' %}"></script>
<script type="module" src="{% static 'js/audio_controls.js' %}"></script>
<script type="text/javascript" src="{% static 'js/loader.js' %}"></script>






  
  
  


</body>
</html>